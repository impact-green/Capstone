{"ast":null,"code":"import _classCallCheck from\"/Users/yueshanlin/Documents/capstoneProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/yueshanlin/Documents/capstoneProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/yueshanlin/Documents/capstoneProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/yueshanlin/Documents/capstoneProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/yueshanlin/Documents/capstoneProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{useState,useEffect}from'react';import Tab from'../Tab/Tab';import Table from'./Table';import DetailContentBottom from'./DetailContentBottom';import SdgsAlignment from'./SdgsAlignment';import FinancialInformation from'./FinancialInformation';import AnnualWaterReduction from'./AnnualWaterReduction';import GHGEmissionBond from'./GHGEmissionBond.js';import'./DetailContent.css';function getfiscalYear(){return new Date().getFullYear()-1;}function numberWithCommas(x){return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\");}var DetailContent=/*#__PURE__*/function(_React$Component){_inherits(DetailContent,_React$Component);var _super=_createSuper(DetailContent);function DetailContent(props){var _this;_classCallCheck(this,DetailContent);_this=_super.call(this,props);_this.state={curTab:'TRACKER',bond:{projects:[]},filterProjects:[]};_this.fetchBond=_this.fetchBond.bind(_assertThisInitialized(_this));_this.onChangeTab=_this.onChangeTab.bind(_assertThisInitialized(_this));_this.getProjectStatus=_this.getProjectStatus.bind(_assertThisInitialized(_this));_this.getPreStatus=_this.getPreStatus.bind(_assertThisInitialized(_this));_this.applyFilter=_this.applyFilter.bind(_assertThisInitialized(_this));return _this;}_createClass(DetailContent,[{key:\"componentDidUpdate\",value:function componentDidUpdate(){}},{key:\"componentWillMount\",value:function componentWillMount(){this.fetchBond();}},{key:\"onChangeTab\",value:function onChangeTab(e){this.setState({curTab:e});}},{key:\"getCounts\",value:function getCounts(climateData){var access=0;var connection=0;var benefit=0;climateData.forEach(function(e){if(e.year==getfiscalYear()){access+=e.people_with_access_to_utilities_count;connection+=e.household_connections_count;benefit+=e.people_benefiting_count;}});return[access,connection,benefit];}},{key:\"getPreStatus\",value:function getPreStatus(climateData){var prefiscalYear=new Date().getFullYear()-2;var not=0;var un=0;var up=0;var bu=0;climateData.forEach(function(e){if(e.year===prefiscalYear){if(e.status=='Not Started'){not++;}if(e.status=='Under Construction'){un++;}if(e.status=='Upgraded'){up++;}if(e.status=='Built'){bu++;}}});return[not,un,up,bu];}},{key:\"getProjectStatus\",value:function getProjectStatus(climateData){var fiscalYear=new Date().getFullYear()-1;var not=0;var un=0;var up=0;var bu=0;climateData.forEach(function(e){if(e.year===fiscalYear){if(e.status=='Not Started'){not++;}if(e.status=='Under Construction'){un++;}if(e.status=='Upgraded'){up++;}if(e.status=='Built'){bu++;}}});return[not,un,up,bu];}},{key:\"getAllYear\",value:function getAllYear(climateData){var fiscalYear=this.getfiscalYear();var year=[];climateData.forEach(function(e){if(parseInt(e.year)<=parseInt(fiscalYear)){if(!year.includes(e.year)){year.push(e.year);}}});return year;}},{key:\"getReduction\",value:function getReduction(climateData){var fiscalYear=getfiscalYear();var data={};climateData.forEach(function(e){if(parseInt(e.year)<=parseInt(fiscalYear)){if(data[e.year]===undefined){data[e.year]=parseInt(e.water_reduction);}else{data[e.year]+=parseInt(e.water_reduction);}}});return data;}},{key:\"getGHGEmissionData\",value:function getGHGEmissionData(climateData){var _this2=this;var fiscalYear=getfiscalYear();var data=[];climateData.forEach(function(e){if(parseInt(e.year)<=parseInt(fiscalYear)){var index=_this2.findWithAttr(data,'year',e.year);if(index==-1){data.push({year:e.year,baseline:parseInt(e.ghg_emissions_business_as_usual),actual:parseInt(e.ghg_emissions_actual_emissions)});}else{data[index].baseline+=parseInt(e.ghg_emissions_business_as_usual);data[index].actual+=parseInt(e.ghg_emissions_actual_emissions);}}});return data;}},{key:\"findWithAttr\",value:function findWithAttr(array,attr,value){for(var i=0;i<array.length;i+=1){if(array[i][attr]===value){return i;}}return-1;}},{key:\"applyFilter\",value:function applyFilter(sdg,sdgsArray){if(sdg=='part'){var temp=this.state.bond.projects.filter(function(e){return e.sdgs.includes(sdgsArray.value);});this.setState({filterProjects:temp});}else{this.setState({filterProjects:this.state.bond.projects});}}},{key:\"fetchBond\",value:function fetchBond(){var _this3=this;fetch(\"http://localhost:8000/api/bond/\".concat(this.props.match.params.id)).then(function(response){return response.json();}).then(function(data){return _this3.setState({bond:data,filterProjects:data.projects});});}},{key:\"render\",value:function render(){var curTab=this.state.curTab;var climateData=[];var status=[];var preStatus=[];var counts=[];var access=-1;var connection=-1;var benefit=-1;var bondType=\"WATER REDUCTION\";var bondUnit=\"Tons\";var reductionData={};var self=this;var ghgData={};if(this.state.bond.climate_impact!=undefined){climateData=this.state.bond.climate_impact;}var fiscalYear=getfiscalYear();if(climateData!=undefined&&climateData.length>0){status=this.getProjectStatus(climateData);preStatus=this.getPreStatus(climateData);counts=this.getCounts(climateData);reductionData=this.getReduction(climateData);ghgData=this.getGHGEmissionData(climateData);}if(this.state.bond.enterprise!=undefined){switch(this.state.bond.enterprise){case\"Power\":bondType=\"ENERGY SAVINGS\";bondUnit=\"Joules\";break;case\"Wastewater\":bondType=\"WATER TREATED, REUSED, AND AVOIDED\";bondUnit=\"Joules\";break;}}access=counts[0];connection=counts[1];benefit=counts[2];var diff=[status[0]-preStatus[0],status[1]-preStatus[1],status[2]-preStatus[2],status[3]-preStatus[3]];return/*#__PURE__*/React.createElement(\"div\",{className:\"DetailContent\"},/*#__PURE__*/React.createElement(Tab,{change:this.onChangeTab,bond:this.state.bond}),curTab==='TRACKER'&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"DetailContentProject\"},/*#__PURE__*/React.createElement(\"div\",{className:\"DetailContentProjectInner\"},/*#__PURE__*/React.createElement(\"div\",{className:\"DetailContentProjectCard\",style:{margin:'0 31px'}},/*#__PURE__*/React.createElement(\"div\",{className:\"DetailContentProjectCardTop\"},/*#__PURE__*/React.createElement(\"div\",{className:\"title\"},\"SDG Alignment\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{className:\"desc\"},\"Amount [$]\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"DetailContentProjectCardBottom\"},/*#__PURE__*/React.createElement(SdgsAlignment,{changeFilter:this.applyFilter,projects:this.state.bond.projects}))),/*#__PURE__*/React.createElement(\"div\",{className:\"DetailContentProjectCard\",style:{margin:'0 31px'}},/*#__PURE__*/React.createElement(\"div\",{className:\"DetailContentProjectCardTop\"},/*#__PURE__*/React.createElement(\"div\",{className:\"title\"},\"FINANCIAL INFORMATION\")),/*#__PURE__*/React.createElement(\"div\",{className:\"DetailContentProjectCardBottom\"},/*#__PURE__*/React.createElement(FinancialInformation,{bond:this.state.bond})))),/*#__PURE__*/React.createElement(\"p\",{className:\"cardName\"},\"VIEWING : ALL PROJECTS\")),/*#__PURE__*/React.createElement(Table,{projects:this.state.filterProjects}),/*#__PURE__*/React.createElement(DetailContentBottom,{bond:this.state.bond})),curTab==='IMPACT'&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"impactTop\"},/*#__PURE__*/React.createElement(\"div\",{className:\"text-area\"},/*#__PURE__*/React.createElement(\"div\",{className:\"text\"},\"Track the climate impacts of projects funded by this specific bond. All metrics are those recommended by the ICMA\",/*#__PURE__*/React.createElement(\"br\",null),\"Harmonized Framework for Green Bond Impact Reporting. Some metrics are only tracked exclusively for certain enterprises.\",/*#__PURE__*/React.createElement(\"br\",null),\"In some instances, issuers may not be able to disclose all information related to all metrics due to internal limitations. \"))),/*#__PURE__*/React.createElement(\"div\",{className:\"impactBottom\"},/*#__PURE__*/React.createElement(\"div\",{className:\"impactChart\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-info\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-txt1\"},\"MEASURING SOCIAL IMPACT\"),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-txt2\"},\"Track the climate impacts of projects funded by this specific bond. All metrics are those\",/*#__PURE__*/React.createElement(\"br\",null),\"recommended by the ICMA Harmonized Framework for Green Bond Impact Reporting. \"),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data-info\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data-txt1\"},numberWithCommas(access)),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data-txt2\"},\"Residents with Equitable and Clean Access to Utilities\"),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data-txt3\"},\"*Number of People with Access to Clean Water\")),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data-info\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data-txt1\"},numberWithCommas(benefit)),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data-txt2\"},\"SF Residents Benefitting from Climate Mitigation Efforts\")),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data-info\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data-txt1\"},numberWithCommas(connection)),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data-txt2\"},\"New Household  Connections\"),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-impact-data-txt3\"},\"*Number of New Household Water Connections\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-left\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-left-txt1\"},\"ANNUAL \",bondType),/*#__PURE__*/React.createElement(\"div\",{className:\"flex space-bet\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-left-txt2\"},\"Amount in \",bondUnit)),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-bar\",id:\"water-page-line-chart\"},/*#__PURE__*/React.createElement(AnnualWaterReduction,{data:reductionData}))),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex space-bet\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-txt1\"},\"PROJECT STATUS\"),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-txt2\"},\"As of June 30, \",fiscalYear)),/*#__PURE__*/React.createElement(\"div\",{className:\"flex space-bet\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-case\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-button background1\"},/*#__PURE__*/React.createElement(\"span\",{className:\"wrapper-char-right-txt5\"},status[0]),/*#__PURE__*/React.createElement(\"span\",{className:\"triangle-\".concat(diff[0]<0?'down':'up')}),/*#__PURE__*/React.createElement(\"span\",{className:\"wrapper-char-right-txt6\"},status[0]-preStatus[0])),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-txt4\"},\"Not Started\")),/*#__PURE__*/React.createElement(\"div\",{className:\"flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-button background2\"},/*#__PURE__*/React.createElement(\"span\",{className:\"wrapper-char-right-txt5\"},status[1]),/*#__PURE__*/React.createElement(\"span\",{className:\"triangle-\".concat(diff[0]<0?'down':'up')}),/*#__PURE__*/React.createElement(\"span\",{className:\"wrapper-char-right-txt6\"},status[1]-preStatus[1])),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-txt4\"},\"Under Construction\")),/*#__PURE__*/React.createElement(\"div\",{className:\"flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-button background3\"},/*#__PURE__*/React.createElement(\"span\",{className:\"wrapper-char-right-txt5\"},status[2]),/*#__PURE__*/React.createElement(\"span\",{className:\"triangle-\".concat(diff[0]<0?'down':'up')}),/*#__PURE__*/React.createElement(\"span\",{className:\"wrapper-char-right-txt6\"},status[2]-preStatus[2])),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-txt4\"},\"Upgraded\")),/*#__PURE__*/React.createElement(\"div\",{className:\"flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-button background4\"},/*#__PURE__*/React.createElement(\"span\",{className:\"wrapper-char-right-txt5\"},status[3]),/*#__PURE__*/React.createElement(\"span\",{className:\"triangle-\".concat(diff[0]<0?'down':'up')}),/*#__PURE__*/React.createElement(\"span\",{className:\"wrapper-char-right-txt6\"},status[3]-preStatus[3])),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-txt4\"},\"Built\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-char-right-txt3\"},\"The goal is to \",/*#__PURE__*/React.createElement(\"span\",null,\"prioritize low-carbon alternatives\"),\" of important community investments. Establishing a conventional project to compare against mitigation alternatives is critical for quantifying greenhouse gas reductions.\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-news\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-news-left\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-news-left-txt1\"},\"ANNUAL GHG EMISSIONS\"),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-news-left-txt2\"},\"The goal is to \",/*#__PURE__*/React.createElement(\"span\",null,\"prioritize\",/*#__PURE__*/React.createElement(\"br\",null),\" low-carbon alternatives\"),\" of \",/*#__PURE__*/React.createElement(\"br\",null),\"important community \",/*#__PURE__*/React.createElement(\"br\",null),\"investments. Establishing a conventional project to compare against mitigation alternatives is critical for quantifying greenhouse gas reductions.\",/*#__PURE__*/React.createElement(\"span\",null,\"Wedge\"),\" is the difference between emissions for conventional investment choices and emissions from actual investments selected for financing in CIP.\")),/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper-news-right\",id:\"water-page-bar-char\"},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',justifyContent:'space-between'}},/*#__PURE__*/React.createElement(\"div\",{className:\"waterInfoContent-tab3-demo\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-r\"},/*#__PURE__*/React.createElement(\"div\",{className:\"waterInfoContent-tab3-bg3\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"waterInfoContent-tab3-txt2 line20\"},\"Baseline\")),/*#__PURE__*/React.createElement(\"div\",{className:\"flex-r\"},/*#__PURE__*/React.createElement(\"div\",{className:\"waterInfoContent-tab3-bg4\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"waterInfoContent-tab3-txt2 line20\"},\"Actual\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"waterInfoContent-tab3-txt2 waterInfoContent-tab3-bg2 line30\"},\"Raw Amount [kg]\")),/*#__PURE__*/React.createElement(\"div\",{style:{marginTop:'25px'}},/*#__PURE__*/React.createElement(GHGEmissionBond,{data:ghgData})))))))));}}]);return DetailContent;}(React.Component);export default DetailContent;","map":{"version":3,"sources":["/Users/yueshanlin/Documents/capstoneProject/src/components/DetailContent/DetailContent.js"],"names":["React","useState","useEffect","Tab","Table","DetailContentBottom","SdgsAlignment","FinancialInformation","AnnualWaterReduction","GHGEmissionBond","getfiscalYear","Date","getFullYear","numberWithCommas","x","toString","replace","DetailContent","props","state","curTab","bond","projects","filterProjects","fetchBond","bind","onChangeTab","getProjectStatus","getPreStatus","applyFilter","e","setState","climateData","access","connection","benefit","forEach","year","people_with_access_to_utilities_count","household_connections_count","people_benefiting_count","prefiscalYear","not","un","up","bu","status","fiscalYear","parseInt","includes","push","data","undefined","water_reduction","index","findWithAttr","baseline","ghg_emissions_business_as_usual","actual","ghg_emissions_actual_emissions","array","attr","value","i","length","sdg","sdgsArray","temp","filter","sdgs","fetch","match","params","id","then","response","json","preStatus","counts","bondType","bondUnit","reductionData","self","ghgData","climate_impact","getCounts","getReduction","getGHGEmissionData","enterprise","diff","margin","display","justifyContent","marginTop","Component"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Tab from '../Tab/Tab'\r\nimport Table from './Table'\r\nimport DetailContentBottom from './DetailContentBottom'\r\nimport SdgsAlignment from './SdgsAlignment'\r\nimport FinancialInformation from './FinancialInformation';\r\nimport AnnualWaterReduction from './AnnualWaterReduction';\r\nimport GHGEmissionBond from './GHGEmissionBond.js';\r\n\r\n\r\n\r\nimport './DetailContent.css'\r\n\r\n\r\nfunction getfiscalYear() {\r\n  return new Date().getFullYear()-1;\r\n}\r\n\r\nfunction numberWithCommas(x) {\r\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n}\r\n\r\n\r\n\r\n\r\nclass DetailContent extends React.Component {\r\n\r\n    constructor(props) {\r\n    super(props);\r\n    this.state ={\r\n      curTab: 'TRACKER',\r\n      bond:{\r\n        projects:[]\r\n      },\r\n      filterProjects:[]\r\n      \r\n    }\r\n    this.fetchBond = this.fetchBond.bind(this)\r\n    this.onChangeTab = this.onChangeTab.bind(this)\r\n    this.getProjectStatus = this.getProjectStatus.bind(this)\r\n    this.getPreStatus = this.getPreStatus.bind(this)\r\n    this.applyFilter = this.applyFilter.bind(this)\r\n  }\r\n  \r\n  componentDidUpdate() {\r\n\r\n  }\r\n\r\n  componentWillMount() {\r\n    this.fetchBond();\r\n  }\r\n\r\n  onChangeTab(e) {\r\n\r\n     this.setState({curTab: e})\r\n  }\r\n\r\n  getCounts(climateData) {\r\n    var access = 0;\r\n    var connection = 0;\r\n    var benefit = 0;\r\n    climateData.forEach(e => {\r\n      if(e.year == getfiscalYear()) {\r\n        access += e.people_with_access_to_utilities_count;\r\n        connection += e.household_connections_count;\r\n        benefit += e.people_benefiting_count;\r\n  \r\n      }\r\n    })\r\n    return [access, connection, benefit];\r\n  }\r\n\r\n  getPreStatus(climateData) {\r\n    var prefiscalYear = new Date().getFullYear()-2;\r\n    var not = 0;\r\n    var un = 0;\r\n    var up = 0;\r\n    var bu = 0;\r\n    climateData.forEach(e => {\r\n    if(e.year === prefiscalYear) {\r\n      if(e.status == 'Not Started') {\r\n        not++;\r\n\r\n      }\r\n      if (e.status == 'Under Construction') {\r\n        un++;\r\n\r\n      }\r\n      if (e.status == 'Upgraded') {\r\n        up++;\r\n\r\n      }\r\n      if (e.status == 'Built') {\r\n        bu++;\r\n\r\n      }\r\n    }})\r\n\r\n    return [not, un, up, bu]\r\n  }\r\n  getProjectStatus(climateData) {\r\n    var fiscalYear = new Date().getFullYear()-1;\r\n    var not = 0;\r\n    var un = 0;\r\n    var up = 0;\r\n    var bu = 0;\r\n    climateData.forEach(e => {\r\n    if(e.year === fiscalYear) {\r\n      if(e.status == 'Not Started') {\r\n        not++;\r\n\r\n      }\r\n      if (e.status == 'Under Construction') {\r\n        un++;\r\n\r\n      }\r\n      if (e.status == 'Upgraded') {\r\n        up++;\r\n\r\n      }\r\n      if (e.status == 'Built') {\r\n        bu++;\r\n\r\n      }\r\n    }})\r\n\r\n    return [not, un, up, bu]\r\n  }\r\n\r\n  getAllYear(climateData) {\r\n    var fiscalYear = this.getfiscalYear();\r\n    var year = [];\r\n    climateData.forEach(e => {\r\n      if(parseInt(e.year)<=parseInt(fiscalYear)) {\r\n        if(!year.includes(e.year)) {\r\n          year.push(e.year);\r\n        }\r\n      }\r\n    })\r\n    return year;\r\n  }\r\n\r\n  getReduction(climateData) {\r\n    var fiscalYear = getfiscalYear();\r\n    var data = {}\r\n    climateData.forEach(e => {\r\n      if(parseInt(e.year)<=parseInt(fiscalYear)) {\r\n        if(data[e.year] === undefined) {\r\n          data[e.year] = parseInt(e.water_reduction);\r\n        }\r\n        else {\r\n          data[e.year] += parseInt(e.water_reduction);\r\n        }\r\n      }\r\n    })\r\n    return data;\r\n  }\r\n\r\n  getGHGEmissionData(climateData) {\r\n    var fiscalYear = getfiscalYear();\r\n    var data = []\r\n    climateData.forEach(e => {\r\n      if(parseInt(e.year)<=parseInt(fiscalYear)) {\r\n        var index = this.findWithAttr(data, 'year', e.year);\r\n        if(index == -1) {\r\n          data.push( {year: e.year, baseline: parseInt(e.ghg_emissions_business_as_usual), actual: parseInt(e.ghg_emissions_actual_emissions)});\r\n        }\r\n        else {\r\n          data[index].baseline += parseInt(e.ghg_emissions_business_as_usual);\r\n          data[index].actual += parseInt(e.ghg_emissions_actual_emissions);\r\n        }\r\n      }\r\n    });\r\n    return data;\r\n  }\r\n\r\n  findWithAttr(array, attr, value) {\r\n    for(var i = 0; i < array.length; i += 1) {\r\n        if(array[i][attr] === value) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n\r\n\r\n  applyFilter(sdg, sdgsArray) {\r\n    if(sdg == 'part') {\r\n      var temp = this.state.bond.projects.filter(\r\n         e=>  {return e.sdgs.includes(sdgsArray.value)\r\n        });\r\n      this.setState({filterProjects: temp})\r\n    }\r\n    else {\r\n      this.setState({filterProjects: this.state.bond.projects})\r\n    }\r\n  }\r\n\r\n  \r\n\r\n  \r\n\r\n  fetchBond()   {\r\n    fetch(`http://localhost:8000/api/bond/${this.props.match.params.id}`)\r\n    .then(response => response.json())\r\n    .then(data =>\r\n      this.setState({bond:data,filterProjects:data.projects})\r\n      )\r\n  }\r\n\r\n  render() {\r\n    var curTab = this.state.curTab;\r\n    var climateData = [];\r\n    var status = [];\r\n    var preStatus = [];\r\n    var counts = [];\r\n    var access = -1;\r\n    var connection = -1;\r\n    var benefit = -1;\r\n    var bondType = \"WATER REDUCTION\";\r\n    var bondUnit = \"Tons\";\r\n    var reductionData = {};\r\n    var self = this;\r\n    var ghgData = {};\r\n    if(this.state.bond.climate_impact != undefined) {\r\n      climateData = this.state.bond.climate_impact\r\n    }  \r\n    var fiscalYear = getfiscalYear();\r\n    if(climateData != undefined && climateData.length >   0) {\r\n      status = this.getProjectStatus(climateData);\r\n      preStatus = this.getPreStatus(climateData);\r\n      counts = this.getCounts(climateData);\r\n      reductionData = this.getReduction(climateData);\r\n      ghgData = this.getGHGEmissionData(climateData);\r\n    }\r\n\r\n    if(this.state.bond.enterprise != undefined) {\r\n      switch(this.state.bond.enterprise) {\r\n        case \"Power\":\r\n          bondType = \"ENERGY SAVINGS\";\r\n          bondUnit = \"Joules\"\r\n          break;\r\n          case \"Wastewater\":\r\n            bondType = \"WATER TREATED, REUSED, AND AVOIDED\";\r\n            bondUnit = \"Joules\"\r\n            break;\r\n      }\r\n    }  \r\n    access = counts[0];\r\n    connection = counts[1];\r\n    benefit = counts[2];\r\n    var diff = [status[0]-preStatus[0],status[1]-preStatus[1],status[2]-preStatus[2],status[3]-preStatus[3]]\r\n      return (\r\n    <div className=\"DetailContent\">\r\n      <Tab change={this.onChangeTab} bond={this.state.bond} />\r\n      {\r\n        curTab === 'TRACKER' && <div>\r\n          <div className=\"DetailContentProject\">  \r\n            <div className=\"DetailContentProjectInner\">\r\n              <div className=\"DetailContentProjectCard\" style={{ margin: '0 31px' }}>\r\n                <div className=\"DetailContentProjectCardTop\">\r\n                  <div className=\"title\">SDG Alignment</div>\r\n                  <div >\r\n                    <span className=\"desc\">\r\n                      Amount [$]\r\n                </span>\r\n                  </div>\r\n                </div>\r\n                <div className=\"DetailContentProjectCardBottom\">\r\n                  <SdgsAlignment changeFilter={this.applyFilter} projects={this.state.bond.projects}/>\r\n                </div>\r\n\r\n              </div>\r\n              <div className=\"DetailContentProjectCard\" style={{ margin: '0 31px' }}>\r\n                <div className=\"DetailContentProjectCardTop\">\r\n                  <div className=\"title\">FINANCIAL INFORMATION</div>\r\n\r\n                </div>\r\n                <div className=\"DetailContentProjectCardBottom\">\r\n                  <FinancialInformation bond={this.state.bond}/>\r\n                </div>\r\n\r\n              </div>\r\n\r\n            </div>\r\n            <p className=\"cardName\">\r\n              VIEWING : ALL PROJECTS\r\n        </p>\r\n          </div>\r\n          <Table projects={this.state.filterProjects} />\r\n          <DetailContentBottom bond={this.state.bond}/>\r\n        </div>\r\n      }\r\n      {\r\n\r\n          curTab === 'IMPACT' &&\r\n          <div>\r\n            <div className=\"impactTop\">\r\n              <div className=\"text-area\">\r\n                <div className=\"text\">Track the climate impacts of projects funded by this specific bond. All metrics are those recommended by the ICMA<br></br>\r\n                Harmonized Framework for Green Bond Impact Reporting. Some metrics are only tracked exclusively for certain enterprises.<br></br>\r\n                In some instances, issuers may not be able to disclose all information related to all metrics due to internal limitations. </div>\r\n              </div>\r\n\r\n              </div>\r\n            <div className=\"impactBottom\">\r\n              <div className=\"impactChart\">\r\n              <div className=\"wrapper-info\">\r\n                \r\n      <div className=\"wrapper-impact\">\r\n        <div className=\"wrapper-impact-txt1\">MEASURING SOCIAL IMPACT</div>\r\n        <div className=\"wrapper-impact-txt2\">Track the climate impacts of projects funded by this specific bond. All metrics are those<br></br>\r\n         recommended by the ICMA Harmonized Framework for Green Bond Impact Reporting. </div>\r\n        <div className=\"wrapper-impact-data\">\r\n          <div className=\"wrapper-impact-data-info\">\r\n      <div className=\"wrapper-impact-data-txt1\">{numberWithCommas(access)}</div>\r\n            <div className=\"wrapper-impact-data-txt2\">Residents with Equitable and Clean Access to Utilities</div>\r\n            <div className=\"wrapper-impact-data-txt3\">*Number of People with Access to Clean Water</div>\r\n          </div>\r\n          <div className=\"wrapper-impact-data-info\">\r\n      <div className=\"wrapper-impact-data-txt1\">{numberWithCommas(benefit)}</div>\r\n            <div className=\"wrapper-impact-data-txt2\">SF Residents Benefitting from Climate Mitigation Efforts</div>\r\n          </div>\r\n          <div className=\"wrapper-impact-data-info\">\r\n            <div className=\"wrapper-impact-data-txt1\">{numberWithCommas(connection)}</div>\r\n            <div className=\"wrapper-impact-data-txt2\">New Household  Connections</div>\r\n            <div className=\"wrapper-impact-data-txt3\">*Number of New Household Water Connections</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"wrapper-char\">\r\n        <div className=\"wrapper-char-left\">\r\n          <div className=\"wrapper-char-left-txt1\">\r\n            ANNUAL {bondType}\r\n          </div>\r\n          <div className=\"flex space-bet\">\r\n            <div className=\"wrapper-char-left-txt2\">\r\n              Amount in {bondUnit}\r\n            </div>\r\n          </div>\r\n          <div className=\"wrapper-char-bar\" id=\"water-page-line-chart\">\r\n            <AnnualWaterReduction data={reductionData}  />\r\n            </div>\r\n        </div>\r\n        <div className=\"wrapper-char-right\">\r\n          <div className=\"flex space-bet\">\r\n            <div className=\"wrapper-char-right-txt1\">PROJECT STATUS</div>\r\n      <div className=\"wrapper-char-right-txt2\">As of June 30, {fiscalYear}</div>\r\n          </div>\r\n          <div className=\"flex space-bet\">\r\n            <div className=\"wrapper-char-right-case\">\r\n              <div className=\"flex\">\r\n                <div className=\"wrapper-char-right-button background1\">\r\n      <span className=\"wrapper-char-right-txt5\">{status[0]}</span>\r\n                  <span className={`triangle-${diff[0] < 0 ? 'down' : 'up'}`}></span>\r\n      <span className=\"wrapper-char-right-txt6\">{status[0]-preStatus[0]}</span>\r\n                </div>\r\n                <div className=\"wrapper-char-right-txt4\">Not Started</div>\r\n              </div>\r\n              <div className=\"flex\">\r\n                <div className=\"wrapper-char-right-button background2\">\r\n                  <span className=\"wrapper-char-right-txt5\">{status[1]}</span>\r\n                  <span className={`triangle-${diff[0] < 0 ? 'down' : 'up'}`}></span>\r\n                  <span className=\"wrapper-char-right-txt6\">{status[1]-preStatus[1]}</span>\r\n                </div>\r\n                <div className=\"wrapper-char-right-txt4\">Under Construction</div>\r\n              </div>\r\n              <div className=\"flex\">\r\n                <div className=\"wrapper-char-right-button background3\">\r\n                  <span className=\"wrapper-char-right-txt5\">{status[2]}</span>\r\n                  <span className={`triangle-${diff[0] < 0 ? 'down' : 'up'}`}></span>\r\n                  <span className=\"wrapper-char-right-txt6\">{status[2]-preStatus[2]}</span>\r\n                </div>\r\n                <div className=\"wrapper-char-right-txt4\">Upgraded</div>\r\n              </div>\r\n              <div className=\"flex\">\r\n                <div className=\"wrapper-char-right-button background4\">\r\n                  <span className=\"wrapper-char-right-txt5\">{status[3]}</span>\r\n                  <span className={`triangle-${diff[0] < 0 ? 'down' : 'up'}`}></span>\r\n                  <span className=\"wrapper-char-right-txt6\">{status[3]-preStatus[3]}</span>\r\n                </div>\r\n                <div className=\"wrapper-char-right-txt4\">Built</div>\r\n              </div>\r\n            </div>\r\n            <div className=\"wrapper-char-right-txt3\">\r\n              The goal is to <span>prioritize low-carbon alternatives</span> of important community investments. Establishing a conventional project to compare against mitigation alternatives is critical for quantifying greenhouse gas reductions.\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"wrapper-news\">\r\n        <div className=\"wrapper-news-left\">\r\n          <div className=\"wrapper-news-left-txt1\">ANNUAL GHG EMISSIONS</div>\r\n          <div className=\"wrapper-news-left-txt2\">The goal is to <span>prioritize<br></br> low-carbon alternatives</span> of <br></br>important community <br></br>investments. Establishing a conventional project to compare against mitigation alternatives is critical for quantifying greenhouse gas reductions.\r\n          <span>Wedge</span> is the difference between emissions for conventional investment choices and emissions from actual investments selected for financing in CIP.\r\n          </div>\r\n        </div>\r\n        <div className=\"wrapper-news-right\" id=\"water-page-bar-char\">\r\n          \r\n          <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n            <div className=\"waterInfoContent-tab3-demo\">\r\n              <div className=\"flex-r\">\r\n                <div className=\"waterInfoContent-tab3-bg3\"></div>\r\n                <div className=\"waterInfoContent-tab3-txt2 line20\">Baseline</div>\r\n              </div>\r\n              <div className=\"flex-r\">\r\n                <div className=\"waterInfoContent-tab3-bg4\"></div>\r\n                <div className=\"waterInfoContent-tab3-txt2 line20\">Actual</div>\r\n              </div>\r\n            </div>\r\n            <div className=\"waterInfoContent-tab3-txt2 waterInfoContent-tab3-bg2 line30\">Raw Amount [kg]</div>\r\n            \r\n          </div>\r\n          <div style={{marginTop:'25px'}}>\r\n          <GHGEmissionBond  data={ghgData} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        }\r\n      </div >\r\n    );\r\n  }\r\n\r\n\r\n}\r\n\r\nexport default DetailContent;"]},"metadata":{},"sourceType":"module"}